---
phase: 02-state-operations
plan: 01
type: execute
depends_on: []
files_modified: [src/client/index.ts, src/commands/workflows.ts]
---

<objective>
Add client methods for workflow state operations and implement delete command with confirmation.

Purpose: Establish API client foundation for state operations and provide safe delete functionality.
Output: Working delete command with confirmation prompt and --force flag.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-create-update-commands/01-01-SUMMARY.md

@src/client/index.ts
@src/client/types.ts
@src/commands/workflows.ts

**Tech stack available:** Commander.js, Node.js fetch, chalk
**Established patterns:**
- Client methods: async methods calling `this.request<T>(method, endpoint)`
- Commands: `workflows.command('name').description().argument().option().action(async () => {})`
- Debug logging with `debug(globalOpts, message)`

**Constraining decisions:**
- Phase 1: Used readFile from node:fs/promises for async file operations
- Phase 1: Descriptive error messages for user-facing errors
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add client methods for delete, activate, and deactivate</name>
  <files>src/client/index.ts</files>
  <action>
Add three methods to N8nApiClient class:

1. `deleteWorkflow(id: string): Promise<void>` - DELETE request to `/workflows/${id}`
2. `activateWorkflow(id: string): Promise<N8nWorkflow>` - POST request to `/workflows/${id}/activate`
3. `deactivateWorkflow(id: string): Promise<N8nWorkflow>` - POST request to `/workflows/${id}/deactivate`

Follow existing patterns:
- Use `this.request<T>()` for all HTTP calls
- deleteWorkflow returns void (204 response handled by request method)
- activate/deactivate return the updated workflow
  </action>
  <verify>npm run build succeeds without TypeScript errors</verify>
  <done>Three new methods exist in N8nApiClient, build passes</done>
</task>

<task type="auto">
  <name>Task 2: Add workflows delete command with confirmation</name>
  <files>src/commands/workflows.ts</files>
  <action>
Add `workflows delete <id>` command:

1. Arguments: `<id>` - Workflow ID (required)
2. Options:
   - `--force, -f` - Skip confirmation prompt
   - `--json` - Output as JSON

3. Implementation:
   - If not --force: prompt for confirmation using readline (import from 'node:readline/promises')
   - Prompt: "Delete workflow {id}? (y/N): " - default to No
   - Only proceed if user types 'y' or 'Y'
   - Call `client.deleteWorkflow(id)`
   - On success: print "Workflow {id} deleted" (or JSON { deleted: true, id } if --json)

4. Follow existing command patterns for globalOpts, debug logging, createClient usage

Note: Use readline/promises for interactive prompt - this is Node.js built-in, no new dependencies.
  </action>
  <verify>npm run build succeeds; npm run cli -- workflows delete --help shows command with options</verify>
  <done>Delete command exists with --force flag, confirmation prompt works, build passes</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run cli -- workflows delete --help` shows command with -f/--force option
- [ ] Client has deleteWorkflow, activateWorkflow, deactivateWorkflow methods
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Delete command prompts for confirmation (skipped with --force)
</success_criteria>

<output>
After completion, create `.planning/phases/02-state-operations/02-01-SUMMARY.md`
</output>
