# Codebase Structure

**Analysis Date:** 2026-01-17

## Directory Layout

```
n8n-builder/
├── src/                    # TypeScript source code
│   ├── bin.ts             # CLI entry point (shebang)
│   ├── index.ts           # Program setup, command registration
│   ├── config.ts          # Configuration loading logic
│   ├── client/            # API client
│   ├── commands/          # CLI command handlers
│   ├── errors/            # Custom error classes
│   └── utils/             # Shared utilities
├── dist/                   # Compiled JavaScript (gitignored)
├── .planning/              # GSD planning documents
├── package.json           # Project manifest
├── tsconfig.json          # TypeScript configuration
├── vitest.config.ts       # Test configuration
├── .env                   # Local environment (gitignored)
├── .env.example           # Environment template
├── CLAUDE.md              # Claude Code instructions
└── README.md              # User documentation
```

## Directory Purposes

**src/**
- Purpose: All TypeScript source code
- Contains: Entry points, commands, client, utilities
- Key files: `bin.ts` (entry), `index.ts` (setup), `config.ts` (config loading)

**src/client/**
- Purpose: HTTP client for n8n API
- Contains: `N8nApiClient` class and TypeScript interfaces
- Key files: `index.ts` (client class), `types.ts` (interfaces)

**src/commands/**
- Purpose: CLI command implementations
- Contains: One file per command group
- Key files: `workflows.ts`, `test.ts`, `config.ts`

**src/errors/**
- Purpose: Custom error class definitions
- Contains: Error hierarchy for API, auth, connection errors
- Key files: `index.ts` (all error classes)

**src/utils/**
- Purpose: Shared utility functions
- Contains: Client factory, error handling, output formatting, environment detection, config persistence
- Key files: `client.ts`, `errors.ts`, `output.ts`, `env.ts`, `configStore.ts`

**dist/**
- Purpose: Compiled JavaScript output
- Source: Generated by `tsc` during build
- Committed: No (in .gitignore)

## Key File Locations

**Entry Points:**
- `src/bin.ts` - CLI entry point with shebang
- `src/index.ts` - Program setup, exports `run()` and `program`

**Configuration:**
- `tsconfig.json` - TypeScript compiler options
- `vitest.config.ts` - Test runner configuration
- `.env.example` - Environment variable template
- `package.json` - Scripts, dependencies, bin mapping

**Core Logic:**
- `src/client/index.ts` - `N8nApiClient` class
- `src/config.ts` - Configuration loading with priority
- `src/utils/configStore.ts` - Persisted config file operations

**Testing:**
- `src/config.test.ts` - Configuration tests
- `src/utils/configStore.test.ts` - Config store tests
- `vitest.config.ts` - Test configuration

**Documentation:**
- `README.md` - User-facing installation and usage
- `CLAUDE.md` - Instructions for Claude Code

## Naming Conventions

**Files:**
- camelCase for TypeScript modules: `configStore.ts`, `client.ts`
- lowercase for entry points: `bin.ts`, `index.ts`
- `.test.ts` suffix for test files (co-located)

**Directories:**
- lowercase singular: `client/`, `commands/`, `utils/`, `errors/`
- Purpose-based naming

**Special Patterns:**
- `index.ts` for directory main exports
- Re-exports: `export * from './types.js'`

## Where to Add New Code

**New Command:**
- Implementation: `src/commands/{command-name}.ts`
- Registration: Add `registerXxxCommand(program)` call in `src/index.ts`
- Tests: `src/commands/{command-name}.test.ts`

**New API Method:**
- Implementation: Add method to `N8nApiClient` in `src/client/index.ts`
- Types: Add interfaces to `src/client/types.ts`
- Tests: `src/client/index.test.ts`

**New Utility:**
- Implementation: `src/utils/{utility-name}.ts`
- Tests: `src/utils/{utility-name}.test.ts`
- Export: Import where needed

**New Error Type:**
- Definition: `src/errors/index.ts`
- Handling: Add case to `analyzeError()` in `src/utils/errors.ts`

## Special Directories

**dist/**
- Purpose: Compiled JavaScript output
- Source: Generated by TypeScript compiler
- Committed: No (gitignored)

**.planning/**
- Purpose: GSD planning system documents
- Contains: Codebase analysis, project plans
- Committed: Yes

**.claude/**
- Purpose: Claude Code settings
- Contains: Configuration for Claude Code
- Committed: Varies

---

*Structure analysis: 2026-01-17*
*Update when directory structure changes*
